---
title: "三门问题精解"
subtitle: ""
date: 2022-04-21T20:36:36+08:00
draft: false
author: "bugxch"
authorLink: "https://bugxch.github.io"
description: ""
math: true

tags: ["math","bayes"]
categories: ["技艺"]

image: "https://cdn.pixabay.com/photo/2018/10/01/13/53/droplet-3716288_960_720.jpg"
---
书接[上文](https://bugxch.github.io/detection/)，使用贝叶斯定理解释著名的[Monty Hall问题](https://www.wikiwand.com/zh/%E8%92%99%E6%8F%90%E9%9C%8D%E7%88%BE%E5%95%8F%E9%A1%8C)，思索清楚之后感觉挺有趣，分享下。

## 问题描述

> 參賽者會看見三扇門，其中一扇門的裏面有一輛汽車，選中裏面是汽車的那扇門，就可以贏得該輛汽車，另外兩扇門裏面則都是一隻山羊。當參賽者選定了一扇門，**主持人會開啟另一扇是山羊的門**；並問：「要不要換一扇門？」

![](https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/Monty_open_door.svg/440px-Monty_open_door.svg.png)

我想大多数人的答案应该是无论换不换门，结果都是一样，赢得比赛的概率是1/2，但是实际的答案是，**换一扇门赢面更大**，准确得说换一扇门赢得比赛的概率是不换门的2倍。为什么会是这样呢？

## 分析解答

为了对这个问题做精确的解答，我们有必要对问题的描述做更详细的澄清。当前的这个游戏满足如下的条件：

- 參賽者在三扇門中挑選一扇。他並不知道內裏有甚麼。
- 主持人知道每扇門後面有什麼。
- 主持人必須開啓剩下的其中一扇門，並且必須提供換門的機會。
- 主持人永遠都會挑一扇有山羊的門。
  - 如果參賽者挑了一扇有山羊的門，主持人必須挑另一扇有山羊的門。
  - 如果參賽者挑了一扇有汽車的門，主持人隨機（概率均勻分佈）在另外兩扇門中挑一扇有山羊的門。
- 參賽者會被問是否保持他的原來選擇，還是轉而選擇剩下的那一道門。

### 朴素分析

使用穷举法分析概率，假设3扇门的编号分别是1，2，3，根据最初选择的编号，以及奖品所在门的编号，可以画出下面的表格

| 初始选择门编号 | 奖品所在门编号 | 不换门结果 | 换门结果 |
| :------------: | :------------: | :--------: | :------: |
|       1       |       1       |     赢     |    输    |
|       1       |       2       |     输     |    赢    |
|       1       |       3       |     输     |    赢    |
|       2       |       1       |     输     |    赢    |
|       2       |       2       |     赢     |    输    |
|       2       |       3       |     输     |    赢    |
|       3       |       1       |     输     |    赢    |
|       3       |       2       |     输     |    赢    |
|       3       |       3       |     赢     |    输    |

上面的表格囊括了所有的情况。第一行的结果很明显，第二行的情况是，主持人肯定会打开编号3的门（因为只有这个门的后面不是奖品），所以如果换门肯定就是换到2号门，那么就赢了，其他的情况类似。这时，可以数一数后面两列的结果，换门有6次赢，是不换门的2倍（只有3次赢）。

### 贝叶斯定理

参考[新冠检测后面的数学定理](https://bugxch.github.io/detection/)里面的贝叶斯定理，我们推算下这个令人吊诡的结论是如何产生的。我们假设有三扇门的编号分别是A、B和C。在没有任何其他信息的情况下，你选择了A作为答案。此时

$$
Pr(A) = Pr(B) = Pr(C) = \frac{1}{3}
$$

其中

- A表示奖品在A门后的概率
- B表示奖品在B门后的概率
- C表示奖品在C门后的概率

可以看出此时无论你选择哪一扇门赢得比赛的概率都一样。

> 然后，蒙蒂打开了C门，告诉你C门后面没有奖品，所以你知道$Pr(C) = 0$，那此时你对$Pr(A)$和$Pr(B)$的估计还保持原样吗？

我们令E表示蒙蒂选择C门作为展示门（以表明该门后面没有奖品）这个事件，那么实际上要比较的就是$Pr(A|E)$和$Pr(B|E)$的大小关系。根据贝叶斯定理

现在已知，$Pr(A) = Pr(B) = Pr(C) = \frac{1}{3}$，下一步就是推导

- $Pr(E|A) = 1/2$，因为如果奖品在A门后面，那么蒙蒂可能选择B门也可能选择C门作为展示门，那么选择C门作为展示门的概率是1/2；
- $Pr(E|B) = 1$，因为如果奖品在B门后面，那么蒙蒂只能选择C门作为展示门；
- $Pr(E|C) = 0$，因为如果奖品在C门后面，那么蒙蒂不可能选择C门作为展示门；

实际上，到这一步已经可以看出来了$Pr(A|E) = \frac{Pr(B|E)} 2$的结果了。但是，可以更进一步计算

$$
\begin{align}
Pr(E) &= Pr(A)Pr(E|A) + Pr(B)Pr(E|B) + Pr(C)Pr(E|C)\\
&=\frac{1}{3}\times \frac{1}{2} + \frac{1}{3}\times 1 + \frac{1}{3}\times 0\\
& = \frac{1}{2}
\end{align}
$$

带入上面的公式，可以得到$Pr(A|E) = \frac{1}{3}$和$Pr(B|E) = \frac{2}{3}$

## 为什么会错？

我们的大脑在分析这个问题时，做了不切实际的假设，并且对这个假设深信不疑。我们习惯于分析**相互独立的随机事件**，最典型的例子是抛硬币，抛掷一枚硬币正面朝上的概率是0.5，我们得到这个结论的依据是**特定结果数量与结果总数的比例**，正面的情况是1，总的结果是2，所以概率是1/2。这就是为什么我们认为无论更换与否，赢得的概率一样的原因。但是实际的情况并不是这样的，**选择换门与否并不是相互独立随机事件**，下面我们做更进一步的说明。

第一步，随机选择一扇门，这个的确是随机的，无论选择哪一扇门，最终赢得比赛的概率是1/3。但是整个事件的随机独立性在蒙蒂选择打开哪扇门的时候发生了变化，

1. 他事先不知道没有被你选中的那两扇门后面奖品的情况，他**随机选择**任意扇门；
2. 他事先知道另外两扇门后面奖品的情况，他**故意选择**了那一扇没有奖品的门

上面的两种情况的随机独立性完全不同，

- 第一种情况，对于蒙蒂来说选择两扇门中的任意一个就像投掷硬币一样，两扇门对于他来讲是平等的选择，他选择任意扇门的概率是1/2。
- 第二种情况，他倾向于选择没有奖品的那扇门，这次的选择不是随机的，而是有意识的选择，尤其当两扇门中有一扇有奖品的时候，他**必然**会选择没有奖品的那扇门，此时选择那扇门的概率是1，而不是1/2。这样的选择具有**倾向性**，而不是**随机决策**的结果。实际上，他排除了不是奖品的那扇门，所以**剩下来的那扇门有奖品的概率更高**，而不是和他选择打开的那扇门的概率相同。

这里是另一种分析的思路，初始选择中，假设你选择了A，那么A门有奖品的概率是$\frac{1}{3}$，B门和C门有奖品的概率是$\frac{2}{3}$。B门和C门至少有一扇门是没有奖品的，蒙蒂知道奖品的位置，他打开那扇没有奖品的门，假设是C门。那剩下B门有奖品的概率就变成了$\frac{2}{3}$！**蒙蒂帮你排除了没有奖品的那扇门**，所以你换门之后赢得的概率一定是$\frac{2}{3}$！

## 问题变种

这个问题的变种是，在你选定门之后，节目组请另一个嘉宾在你没有选定的两扇门里面随机选定一扇门，那扇门后面没有山羊，那么他打开其中任意一扇门，显示是山羊，此时更换选择的赢面是否更大？注意，这个嘉宾事先不清楚奖品在那一扇门后面。

答案是否，无论是否更换选择，两个的概率都是1/2。参考之前的贝叶斯定理的推理，假设同前，你选了A门，那么此时嘉宾需要在B和C门直接选一个门，

- $Pr(E|A) = 1/2$，因为如果奖品在A门后面，这里的概率分两步，第一步是选择C门，嘉宾选择的概率是1/2，第二步是C门后面是羊的概率，此时是1，所以最终的概率是1/2 * 1 = 1/2；
- $Pr(E|B) = 1/2$，分析同上；
- $Pr(E|C) = 0$，第二步C门后面是羊的概率是0，所以按照上面的分析最终的概率是1/2*0 =0。

可以看出无论更换与否，中奖的概率都是一样的。

## 参考资料

1. [Monty Hall revisited](https://www.maa.org/external_archive/devlin/devlin_12_05.html)，问题的数学推导
2. [蒙提霍爾問題 - Wikiwand](https://www.wikiwand.com/zh/%E8%92%99%E6%8F%90%E9%9C%8D%E7%88%BE%E5%95%8F%E9%A1%8C)，维基百科描述
3. [Monty Hall Problem: Solution Explained Simply - Statistics How To](https://www.statisticshowto.com/probability-and-statistics/monty-hall-problem/)，一篇精湛的统计学分析

---

全文完🚀
